<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Summarizes data.</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>#Worm plotting
#06/02/2021
#Sara DeLaurentis
#create summarized worm data</p>

<pre><code class="r">library(tidyverse)
library(glue)
library(stringr)
library(magrittr)
library(dplyr)


getwd()
</code></pre>

<pre><code>## [1] &quot;C:/Users/sbaue/coding/R_TEMPRY/Itasca_project_19-21/Itasca_19-20&quot;
</code></pre>

<p>No NA values for data entries, but there are UNK for some of the ID values. Will need to remove those.</p>

<pre><code class="r">worms &lt;- read.csv(&quot;ItascaEarthwormData_2019.csv&quot;)
head(worms)
</code></pre>

<pre><code>##          notes      date site_name inv_lvl forest_type treatment rep layer
## 1              9/21/2019     C2AR1       2           C       C2A  R1   org
## 2              9/21/2019     C2AR1       2           C       C2A  R1   org
## 3  cracked cap 9/21/2019     C2AR1       2           C       C2A  R1   min
## 4 missing head 9/21/2019     C2AR1       2           C       C2A  R1   min
## 5              9/21/2019     C2AR1       2           C       C2A  R1   min
## 6              9/21/2019     C2AR1       2           C       C2A  R1   min
##                species growth_stage ecol_group length_mm LN_length
## 1 Dendrobaena octaedra        adult    epigeic        19  2.944439
## 2 Dendrobaena octaedra          juv    epigeic        12  2.484907
## 3 Dendrobaena octaedra          juv    epigeic        18  2.890372
## 4 Dendrobaena octaedra          juv    epigeic        22  3.091042
## 5 Dendrobaena octaedra          juv    epigeic        15  2.708050
## 6 Dendrobaena octaedra          juv    epigeic        10  2.302585
##   calc_LN_biomass biomass_AFDg  area_m2
## 1       -5.110987  0.006030130 0.080425
## 2       -6.322544  0.001795371 0.080425
## 3       -5.253535  0.005229002 0.080425
## 4       -4.724467  0.008875447 0.080425
## 5       -5.734226  0.003233385 0.080425
## 6       -6.803234  0.001110179 0.080425
</code></pre>

<pre><code class="r">view(worms)
</code></pre>

<p>Add column for invasion level, then column for forest type. Overwrite csv and check.</p>

<pre><code class="r">worms &lt;- worms %&gt;% 
  mutate(inv_lvl = case_when(
    grepl(&quot;2&quot;, treatment) ~ &quot;2&quot;,
    grepl(&quot;5&quot;, treatment) ~ &quot;5&quot;
  ), .after = &quot;site_name&quot;) 

worms &lt;- worms %&gt;% 
  mutate(forest_type = case_when(
    grepl(&quot;C&quot;, treatment) ~ &quot;C&quot;,
    grepl(&quot;D&quot;, treatment) ~ &quot;D&quot;), .after = &quot;inv_lvl&quot;
  )

view(worms)

write_csv(worms, &quot;ItascaEarthwormdata_2019.csv&quot;)

check &lt;- read.csv(&quot;ItascaEarthwormdata_2019.csv&quot;)
view(check)
</code></pre>

<p>First need to summarize sums by replicate, then take the mean of the group.
Created summarized df, divided biomass totals by the worm ring area to get the biomass totals for each rep.</p>

<pre><code class="r">worm_rep_sum &lt;- 
  worms %&gt;% 
  group_by(treatment, rep) %&gt;% 
  summarise(biomass_AFDg_TOT = sum(biomass_AFDg))
</code></pre>

<pre><code>## `summarise()` has grouped output by &#39;treatment&#39;. You can override using the `.groups` argument.
</code></pre>

<pre><code class="r">worm_rep_sum %&lt;&gt;% 
  mutate(biomass_m2 = biomass_AFDg_TOT/0.080425)

view(worm_rep_sum)  
</code></pre>

<p>redo creation of invasion level and forest type columns (post-summarize)</p>

<pre><code class="r">worm_rep_sum &lt;- worm_rep_sum %&gt;% 
  mutate(inv_lvl = case_when(
    grepl(&quot;2&quot;, treatment) ~ &quot;2&quot;,
    grepl(&quot;5&quot;, treatment) ~ &quot;5&quot;
  ), .after = &quot;treatment&quot;) 

worm_rep_sum &lt;- worm_rep_sum %&gt;% 
  mutate(forest_type = case_when(
    grepl(&quot;C&quot;, treatment) ~ &quot;C&quot;,
    grepl(&quot;D&quot;, treatment) ~ &quot;D&quot;), .after = &quot;treatment&quot;
  )

view(worm_rep_sum)
</code></pre>

<p>Attempt to select one worm group from the original worms dataframe.</p>

<pre><code class="r">Aporr &lt;- worms[worms$species == &quot;Aporrectodea species&quot;,]
view(Aporr)
</code></pre>

<p>Worm scatterplot, checking trends and relationships.</p>

<pre><code class="r">png(&quot;worm_scatter.png&quot;, width = 1000, height = 1000)
worm_scatter &lt;- plot(worms, cex = 2, cex.lab = 2)
print(worm_scatter)
</code></pre>

<pre><code>## NULL
</code></pre>

<pre><code class="r">dev.off()
</code></pre>

<pre><code>## png 
##   2
</code></pre>

<pre><code class="r">?plot
</code></pre>

<p>making our own summarySE function:</p>

<pre><code class="r">wormplot.df &lt;- worm_rep_sum %&gt;% group_by(treatment) %&gt;% 
  summarise(mean = mean(biomass_m2), SD = sd(biomass_m2))
print(wormplot.df)
</code></pre>

<pre><code>## # A tibble: 8 x 3
##   treatment  mean    SD
##   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 C2A        2.23 2.38 
## 2 C2B        1.84 0.984
## 3 C5A        2.53 1.33 
## 4 C5B        3.18 1.19 
## 5 D2A        1.67 0.656
## 6 D2B        1.56 0.505
## 7 D5A        4.06 1.46 
## 8 D5B        3.22 1.09
</code></pre>

<p>wormplot.df &lt;- wormplot.df %&gt;%   #Adding in SE to the dataframe</p>

<pre><code class="r">  mutate(SE = SD/sqrt(length(SD)))
</code></pre>

<pre><code>## Error in mutate(SE = SD/sqrt(length(SD))): object &#39;SD&#39; not found
</code></pre>

<pre><code class="r">print(wormplot.df)
</code></pre>

<pre><code>## # A tibble: 8 x 3
##   treatment  mean    SD
##   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 C2A        2.23 2.38 
## 2 C2B        1.84 0.984
## 3 C5A        2.53 1.33 
## 4 C5B        3.18 1.19 
## 5 D2A        1.67 0.656
## 6 D2B        1.56 0.505
## 7 D5A        4.06 1.46 
## 8 D5B        3.22 1.09
</code></pre>

<p>Error bars represent standard error of the mean</p>

<pre><code class="r">wormplot.FUN &lt;- function(data){
  Wplot &lt;- ggplot(wormplot.df, aes(x = treatment, y = mean, fill = treatment)) +
  geom_col(position = position_dodge()) +
  geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE),
                width = .2,
                position = position_dodge(.9))
  Wplot &lt;- Wplot + ggtitle(&quot;Itasca 2019 Worms&quot;) +
    theme(axis.text.x = element_text(size = rel(1.2))) +
    theme(axis.text.y = element_text(size = rel(1.2))) 

 # print(Wplot) #print
  }
</code></pre>

<p>wormplot.FUN(wormplot.df) run the function
anova comparing the 8 treatment groups:</p>

<pre><code class="r">fm1 &lt;- lm(biomass_m2 ~ treatment, data = worm_rep_sum)
anova(fm1)
</code></pre>

<pre><code>## Analysis of Variance Table
## 
## Response: biomass_m2
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## treatment  7 16.493  2.3562  1.3624 0.2861
## Residuals 16 27.671  1.7294
</code></pre>

<pre><code class="r">summary(fm1)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = biomass_m2 ~ treatment, data = worm_rep_sum)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.76979 -0.81920 -0.06958  0.68036  2.71139 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    2.2262     0.7593   2.932  0.00977 **
## treatmentC2B  -0.3876     1.0738  -0.361  0.72281   
## treatmentC5A   0.3038     1.0738   0.283  0.78084   
## treatmentC5B   0.9489     1.0738   0.884  0.38996   
## treatmentD2A  -0.5608     1.0738  -0.522  0.60860   
## treatmentD2B  -0.6636     1.0738  -0.618  0.54528   
## treatmentD5A   1.8372     1.0738   1.711  0.10640   
## treatmentD5B   0.9943     1.0738   0.926  0.36819   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.315 on 16 degrees of freedom
## Multiple R-squared:  0.3735, Adjusted R-squared:  0.09934 
## F-statistic: 1.362 on 7 and 16 DF,  p-value: 0.2861
</code></pre>

<pre><code class="r">view(worm_rep_sum)
</code></pre>

<p>anova comparing the 2 forest types:</p>

<pre><code class="r">fm2 &lt;- lm(biomass_m2 ~ forest_type, data = worm_rep_sum)
anova(fm2)
</code></pre>

<pre><code>## Analysis of Variance Table
## 
## Response: biomass_m2
##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## forest_type  1  0.206 0.20648  0.1033 0.7509
## Residuals   22 43.958 1.99808
</code></pre>

<pre><code class="r">summary(fm2)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = biomass_m2 ~ forest_type, data = worm_rep_sum)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9861 -1.1847 -0.4883  0.8941  3.0025 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2.4425     0.4081   5.986 5.04e-06 ***
## forest_typeD   0.1855     0.5771   0.321    0.751    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.414 on 22 degrees of freedom
## Multiple R-squared:  0.004675,   Adjusted R-squared:  -0.04057 
## F-statistic: 0.1033 on 1 and 22 DF,  p-value: 0.7509
</code></pre>

<p>anova comparing the 2 invasion levels:</p>

<pre><code class="r">fm3 &lt;- lm(biomass_m2 ~ inv_lvl, data = worm_rep_sum)
anova(fm3)
</code></pre>

<pre><code>## Analysis of Variance Table
## 
## Response: biomass_m2
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## inv_lvl    1 12.168 12.1677  8.3662 0.008451 **
## Residuals 22 31.996  1.4544                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<pre><code class="r">summary(fm3)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = biomass_m2 ~ inv_lvl, data = worm_rep_sum)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.1257 -0.6670 -0.1620  0.5298  3.1144 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.8232     0.3481   5.237 2.97e-05 ***
## inv_lvl5      1.4241     0.4923   2.892  0.00845 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.206 on 22 degrees of freedom
## Multiple R-squared:  0.2755, Adjusted R-squared:  0.2426 
## F-statistic: 8.366 on 1 and 22 DF,  p-value: 0.008451
</code></pre>

<p>plotting residuals to check for equal variance</p>

<pre><code class="r">plot(residuals(fm1) âˆ¼ fitted.values(fm1), main = &quot;fm1 residuals: biomass_m2 ~ Site&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/></p>

<p>based on summary and residual plotting, variances are not equal.</p>

<pre><code class="r">wormplot.df         
</code></pre>

<pre><code>## # A tibble: 8 x 3
##   treatment  mean    SD
##   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 C2A        2.23 2.38 
## 2 C2B        1.84 0.984
## 3 C5A        2.53 1.33 
## 4 C5B        3.18 1.19 
## 5 D2A        1.67 0.656
## 6 D2B        1.56 0.505
## 7 D5A        4.06 1.46 
## 8 D5B        3.22 1.09
</code></pre>

<p>#from: <a href="http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/">http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/</a>
#contains a potentially useful function using plyr (non-tidyverse) that I&#39;ve recreated above. Maybe come back here for the CI information.</p>

<h1>Summarizes data.</h1>

<h1>Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).</h1>

<h1>data: a data frame.</h1>

<h1>measurevar: the name of a column that contains the variable to be summariezed</h1>

<h1>groupvars: a vector containing names of columns that contain grouping variables</h1>

<h1>na.rm: a boolean that indicates whether to ignore NA&#39;s</h1>

<h1>conf.interval: the percent range of the confidence interval (default is 95%)</h1>

<pre><code class="r">summarySE &lt;- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
  library(dplyr)

  # New version of length which can handle NA&#39;s: if na.rm==T, don&#39;t count them
  length2 &lt;- function (x, na.rm=FALSE) {
    if (na.rm) sum(!is.na(x))
    else       length(x)
  }

  # This does the summary. For each group&#39;s data frame, return a vector with
  # N, mean, and sd
  datac &lt;- ddply(data, groupvars, .drop=.drop,
                 .fun = function(xx, col) {
                   c(N    = length2(xx[[col]], na.rm=na.rm),
                     mean = mean   (xx[[col]], na.rm=na.rm),
                     sd   = sd     (xx[[col]], na.rm=na.rm)
                   )
                 },
                 measurevar
  )

  # Rename the &quot;mean&quot; column    
  datac &lt;- rename(datac, c(&quot;mean&quot; = measurevar))

  datac$se &lt;- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

  # Confidence interval multiplier for standard error
  # Calculate t-statistic for confidence interval: 
  # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
  ciMult &lt;- qt(conf.interval/2 + .5, datac$N-1)
  datac$ci &lt;- datac$se * ciMult

  return(datac)
}

?ddply
</code></pre>

<pre><code>## No documentation for &#39;ddply&#39; in specified packages and libraries:
## you could try &#39;??ddply&#39;
</code></pre>

<pre><code class="r">args(mutate)
</code></pre>

<pre><code>## function (.data, ...) 
## NULL
</code></pre>

</body>

</html>
